### Метод Монте-Карло

Метод Монте-Карло - это метод оценки вероятностей путём многократного случайного моделирования исходов.

Суть в том, что вместо точной формулы запускается много случайных "симуляций" события, и по их результатам считается средний или самый вероятностный исход.

Например:

- оценить вероятность победы в покере
- оценить интеграл, который невозможно взять аналитически
- смоделировать цену актива
- смоделировать физический процесс

Метод Монте-Карло очень эффективен, когда аналитический расчёт слишком сложен или невозможен.


---

### Monte-Carlo Tree Search

Если метод Монте-Карло это любой способ решить задачу через многократные случайные симуляции.

То, Monte-Carlo Tree Search (MCTS) - это поиск по дереву, использующий симуляции Монте-Карло.

Главные особенности:

- строим дерево возможных действий
- запускаем много симуляций (неравномерно, хорошие ветви исследуются чаще, плохие - реже)
- накапливаем статистику посещений узлов
- используем формулу для выбора узла

Такой метод использовался в АльфаГо, программе созданной компанией DeepMind (Google) в 2015, для игры в Го.

> Го - это древнейшая интеллектуальная игра, которой более 2000 лет!
>
> Го знаменита своей стратегической глубиной и простыми правилами, которые создают огромное количество комбинаций и стратегий (число возможных позиций больше, чем атомов во Вселенной).
>
> В Го brute-force невозможен, поэтому для эффективной игры нужны вероятностные и обучаемые методы.

Архитектура AlphaGo:
- Policy Network - предсказывает наиболее перспективные ходы, сужает пространство поиска.
- Value Network - оценивает вероятность победы из текущей позиции, позволяет резко ускорить поиск.
- Monte-Carlo Tree Search (MCTS):
    - строит дерево возможных ходов
    - делает множество случайных симуляций (метод Монте-Карло)
    - направляет поиск в наиболее многообещающие ветви

> AlphaGo (2015–2016) тренировалась на партиях людей, после имела огромную серию self-play, имела раздельные policy и value сети, MCTS который сочетал статистику посещений и предсказания (policy/value), и в следствии находил наилучший ход. Все это позволило переиграть сильнейших чемпионов Го.
>
> Го, как самая сложная стратегическая игра с открытой информацией, была чем то вроде лакмусовой бумажки для разработчиков ИИ.
>
> Матч с AlphaGo против Ли Седоля (Сеул, март 2016), победа AlphaGo 4:1, стал переломным моментом.
> Партия №4 (ход 78) - стала одной из самых красивых и редких побед человека над AlphaGo.
>


---

### Монте-Карло в Покере

В покере метод Монте-Карло позволяет оценить вероятность победы конкретной руки против случайных рук противников. Вместо перебора всех возможных комбинаций карт (что заняло бы слишком много времени), мы симулируем тысячи случайных раздач.

Алгоритм такой: берём известные карты (карты игрока и карты на столе), раздаём случайные карты противникам, досдаём оставшиеся карты стола, определяем победителя. Повторяем процесс N раз и считаем процент побед. Чем больше симуляций - тем точнее результат.

Такой подход используется в профессиональных покерных калькуляторах (PokerStove, Equilab) и позволяет игрокам принимать математически обоснованные решения за столом.


#### Интерактивный Monte Carlo Poker Calculator ♠️♥️♣️♦️

 [![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/van4956/project_simulation/main?filepath=01_monte_carlo/poker_simulation.ipynb)  -  Jupyter Notebook

[![Streamlit App](https://static.streamlit.io/badges/streamlit_badge_black_white.svg)](https://poker-calculator.streamlit.app)  -  Web app

Возможности:

- Выбор карт игрока
- Выбор карт стола
- Настройка количества игроков
- Настройка количества симуляций
- Визуализация результатов
- Расчёт вероятности победы в реальном времени
